if(is.null(colors)) colors=c("#6D9EC1","white","#E46726")
cor_mat<-result$r
p_mat<-result$p
diag( cor_mat ) <- NA
diag( p_mat ) <- NA
var1 <- rep( row.names(cor_mat), ncol(cor_mat) )
var2 <- rep( colnames(cor_mat), each = nrow(cor_mat) )
cor <- as.numeric(cor_mat)
cor_mat <- data.frame( var1 = var1, var2 = var2,
cor = cor, stringsAsFactors = FALSE )
pval=as.numeric(p_mat)
cor_mat$label=ifelse(is.na(cor_mat$cor),"",sprintf("%0.2f",cor_mat$cor))
cor_mat$p=ifelse(is.na(pval),"",sprintf("%0.3f",pval))
cor_mat[["tooltip"]] <-
sprintf("<i>%s</i> vs <i>%s</i>:</br><i>r</i> = %s</br><i>p</i> = %s",
var1, var2, cor_mat$label,cor_mat$p)
p <- ggplot(data = cor_mat, aes(x = var1, y = var2,tooltip=tooltip) ) +
geom_tile_interactive(aes(fill = cor), colour = "white") +
scale_fill_gradient2(low = colors[1], mid = colors[2], high = colors[3], limits = c(-1, 1)) +
coord_equal()+
xlab("")+ylab("")
if(title) {
title=paste0(result$out$method,",",result$out$alternative)
p<-p+ggtitle(title)
}
if(label) p<-p+geom_text(aes(label=label))
if(interactive) p<-ggiraph( code = print(p))
p
library(moonBook2)
ggCor(iris)
ggCor(acs)
ggCor(acs,interactive=TRUE)
ggCor(iris,colors=c("red","white","blue"),interactive=TRUE)
ggCor(mtcars,colors=c("red","white","blue"),interactive=TRUE)
ggCor(mtcars,interactive=TRUE)
ggCor(mtcars,label=TRUE,interactive=TRUE)
ggBoxplot(iris)
ggBoxplot(iris,interactive=TRUE)
ggBoxplot(mtcars,horizontal=TRUE,interactive=TRUE)
library(moonBook2)
ggBoxplot(mtcars,horizontal=TRUE,interactive=TRUE)
ggBoxplot(mtcars,horizontal=TRUE,interactive=TRUE)+theme_bw()
ggBoxplot(mtcars,horizontal=TRUE,interactive=TRUE)+theme_bw()
p<-ggBoxplot(mtcars,horizontal=TRUE)+theme_bw()
p<-ggBoxplot(mtcars,horizontal=TRUE)+theme_bw()
ggiraph(code=print(p),zoom_max=10)
ggBoxplot(mtcars,rescale=TRUE,horizontal=TRUE,interactive=TRUE)
library(moonBook2)
ggScatter(radial,xvar="height",yvar="weight",interactive=TRUE)
ggScatter(radial,xvar="height",yvar="weight",methd="lm",interactive=TRUE)
ggScatter(radial,xvar="height",yvar="weight",method="lm",interactive=TRUE)
ggScatter(NTAV~age|smoking,data=radial,fullrange=TRUE,se=FALSE,interactive=TRUE)
ggScatter(NTAV~age|smoking,data=radial,fullrange=TRUE,method="lm",se=FALSE,interactive=TRUE)
ggScatter(radial,xvar="height",yvar="weight",colorvar="sex",method="lm",interactive=TRUE)
ggScatter(radial,xvar="height",yvar="weight",colorvar="sex",facet=TRUE,method="lm",interactive=TRUE)
ggScatter(radial,yvar="NTAV",xvar="age",colorvar="TC",facet=TRUE,method="lm",interactive=TRUE)
str(radial)
ggScatter(radial,yvar="NTAV",xvar="age",colorvar="hsCRP",facet=TRUE,method="lm",interactive=TRUE)
ggScatter(radial,yvar="NTAV",xvar="age",colorvar="hsCRP",facet=TRUE,method="lm",interactive=TRUE)
ggScatter(radial,yvar="NTAV",xvar="age",colorvar="hsCRP",facet=TRUE,interactive=TRUE)
ggScatter(radial,yvar="height",xvar="weight",colorvar="age",facet=TRUE,interactive=TRUE)
ggScatter(acs,yvar="height",xvar="weight",colorvar="age",methd="lm",facet=TRUE,interactive=TRUE)
ggScatter(acs,yvar="height",xvar="weight",colorvar="age",method="lm",facet=TRUE,interactive=TRUE)
ggScatter(acs,yvar="weight",xvar="height",colorvar="age",method="lm",facet=TRUE,interactive=TRUE)
ggScatter(acs,yvar="weight",xvar="height",colorvar="age",method="lm",interactive=TRUE)
ggScatter(acs,yvar="weight",xvar="height",colorvar="age",cut_numbber=4,method="lm",facet=TRUE,interactive=TRUE)
library(moonBook2)
ggScatter(acs,yvar="weight",xvar="height",colorvar="age",cut_number=4,method="lm",facet=TRUE,interactive=TRUE)
library(moonBook2)
ggScatter(acs,yvar="weight",xvar="height",colorvar="age",cut_number=4,method="lm",facet=TRUE,interactive=TRUE)
devtools::document()
library(moonBook2)
require(gcookbook)
str(tophitters2001)
ggCLE(tophitters2001,xvar="rbi",yvar="name",colorvar="lg",facetvar="lg",no=25,interactive=TRUE)
ggCLE(tophitters2001,xvar="rbi",yvar="name",colorvar="lg",facetvar="lg",no=25,interactive=TRUE,deceasing=TRUE)
ggCLE(tophitters2001,xvar="so",yvar="name",colorvar="lg",facetvar="lg",no=25,interactive=TRUE,deceasing=TRUE)
ggCLE(tophitters2001,xvar="so",yvar="name",colorvar="lg",facetvar="lg",no=25,interactive=TRUE,decreasing=TRUE)
ggCLE(tophitters2001,xvar="so",yvar="name",colorvar="lg",facetvar="lg",no=25,interactive=TRUE,decreasing=FALSE)
ggCLE(tophitters2001,xvar="so",yvar="name",colorvar="lg",facetvar="lg",no=20,interactive=TRUE,decreasing=FALSE)
ggCLE(tophitters2001,xvar="so",yvar="name",colorvar="lg",facetvar="lg",no=10,interactive=TRUE,decreasing=FALSE)
ggCLE(tophitters2001,xvar="so",yvar="name",colorvar="lg",facetvar="lg",no=25,interactive=TRUE)
ggCLE(tophitters2001,xvar="so",yvar="name",colorvar="lg",facetvar="lg",no=25,decreasing=TRUE,,interactive=TRUE)
ggCLE(tophitters2001,xvar="so",yvar="name",colorvar="lg",facetvar="lg",no=25,decreasing=TRUE,,interactive=FALSE)
ggCLE(tophitters2001,xvar="so",yvar="name",colorvar="lg",facetvar="lg",no=25,decreasing=FALSE,interactive=TRUE)
ggCLE(tophitters2001,xvar="so",yvar="name",colorvar="lg",facetvar="lg",no=25,decreasing=FALSE,interactive=FALSE)
ggCLE(tophitters2001,xvar="so",yvar="name",colorvar="lg",facetvar="lg",no=25,decreasing=FALSE,interactive=TRUE)
ggCLE(tophitters2001,xvar="so",yvar="name",colorvar="lg",facetvar="lg",no=25,decreasing=FALSE,interactive=FALSE)
library(moonBook2)
devtools::document()
library(moonBook2)
require(ggplot2)
require(ggiraph)
ggDot=function(data,yvar,xvar,fillvar){
ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))+
geom_boxplot(width=0.5)+
geom_dotplot(stackdir='center',binaxis='y',binwidth=0.5)+
theme(legend.position='none')
}
ggDot(radial,yvar="height",xvar="sex",filvar="sex")
ggDot(radial,yvar="height",xvar="sex",fillvar="sex")
require(gcookbook)
ggDot=function(data,yvar,xvar,fillvar=NULL){
ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))+
geom_boxplot(width=0.5)+
geom_dotplot(stackdir='center',binaxis='y',binwidth=0.5)+
theme(legend.position='none')
}
ggDot(heightweight,yvar="heightIn",xvar="sex")
ggDot(heightweight,yvar="heightIn",xvar="sex",fillvar="sex")
ggDot=function(data,yvar,xvar,fillvar=NULL,stackdir="center",binaxis="y",binwidth=0.5){
ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))+
geom_boxplot(width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)+
theme(legend.position='none')
}
require(gcookbook)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex")
ggDot(heightweight,yvar="heightIn",xvar="sex",fillvar="sex")
ggDot(radial,yvar="height",xvar="sex",fillvar="sex")
ggDot(heightweight,yvar="heightIn",xvar="sex",fillvar="sex")
ggDot(radial,yvar="height",xvar="sex",fillvar="sex")
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",stackdir="up",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",stackdir="down",binwidth=1)
ggDot=function(data,yvar,xvar,fillvar=NULL,stackdir="center",binaxis="y",binwidth=0.5,position=0.2){
p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
if(position==0){
p<- p + geom_boxplot(width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)+
} else{
p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, "+ 0.2)"),group=xvar)),width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)+
}
p<-p+theme(legend.position='none')
p
}
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot=function(data,yvar,xvar,fillvar=NULL,stackdir="center",binaxis="y",binwidth=0.5,position=0.2){
p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
if(position==0){
p<- p + geom_boxplot(width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)+
} else{
p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, "+ 0.2)"),group=xvar),width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)+
}
p<-p+theme(legend.position='none')
p
}
ggDot=function(data,yvar,xvar,fillvar=NULL,stackdir="center",binaxis="y",binwidth=0.5,position=0.2){
p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
if(position==0){
p<- p + geom_boxplot(width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)+
} else{
p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, "+ 0.2)"),group=xvar),width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)+
}
p<-p+theme(legend.position='none')
p
}
ggDot=function(data,yvar,xvar,fillvar=NULL,stackdir="center",binaxis="y",binwidth=0.5,position=0.2){
p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
if(position==0){
p<- p + geom_boxplot(width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
} else{
p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, "+ 0.2)"),group=xvar),width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
}
p<-p+theme(legend.position='none')
p
}
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot=function(data,yvar,xvar,fillvar=NULL,stackdir="center",binaxis="y",binwidth=0.5,position=0.2){
p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
if(position==0){
p<- p + geom_boxplot(width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
} else{
p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, ")+ 0.2"),group=xvar),width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
}
p<-p+theme(legend.position='none')
p
}
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot=function(data,yvar,xvar,fillvar=NULL,stackdir="center",binaxis="y",binwidth=0.5,position=0.2){
p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
if(position==0){
p<- p + geom_boxplot(width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
} else{
p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, ")+ 0.2"),group=xvar),width=0.5)+
geom_dotplot(aes_string(x=paste0("as.numeric(",xvar, ")- 0.2"),group=xvar),
stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
p<-p+scale_x_continuous(breaks=1:nlevels(data[[xvar]]),labels=levels(data[[xvar]]))
}
p<-p+theme(legend.position='none')
p
}
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot=function(data,yvar,xvar,fillvar=NULL,stackdir="center",binaxis="y",binwidth=0.5,position=0.2){
p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
if(position==0){
p<- p + geom_boxplot(width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
} else{
p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, ")+ 0.2"),group=xvar),width=0.25)+
geom_dotplot(aes_string(x=paste0("as.numeric(",xvar, ")- 0.2"),group=xvar),
stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
p<-p+scale_x_continuous(breaks=1:nlevels(data[[xvar]]),labels=levels(data[[xvar]]))
}
p<-p+theme(legend.position='none')
p
}
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot(heightweight,yvar="heightIn",xvar="sex",fillvar="sex")
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot=function(data,yvar,xvar,fillvar=NULL,stackdir="center",binaxis="y",binwidth=0.5,position=0.2,boxwidth=0.25){
p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
if(position==0){
p<- p + geom_boxplot(width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
} else{
p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, ")+ 0.2"),group=xvar),width=boxwidth)+
geom_dotplot(aes_string(x=paste0("as.numeric(",xvar, ")- 0.2"),group=xvar),
stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
p<-p+scale_x_continuous(breaks=1:nlevels(data[[xvar]]),labels=levels(data[[xvar]]))
}
p<-p+theme(legend.position='none')
p
}
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot(heightweight,yvar="heightIn",xvar="sex",fillvar="sex")
ggDot(heightweight,yvar="heightIn",xvar="sex")
ggDot(heightweight,yvar="heightIn",xvar="sex")
ggDot(heightweight,yvar="heightIn",xvar="sex",binwidth=0.4)
ggDot(heightweight,yvar="heightIn",xvar="sex",binwidth=0.4,binaxis='x')
ggDot(heightweight,yvar="heightIn",xvar="sex",binwidth=0.4)
ggDot=function(data,xvar,yvar=NULL,fillvar=NULL,stackdir="center",binaxis="y",binwidth=0.5,position=0.2,boxwidth=0.25){
if(is.null(yvar)){
binaxis="x"
p<-ggplot(data,aes_string(x=xvar,fill=fillvar))+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
} else{
p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
if(position==0){
p<- p + geom_boxplot(width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
} else{
p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, ")+ 0.2"),group=xvar),width=boxwidth)+
geom_dotplot(aes_string(x=paste0("as.numeric(",xvar, ")- 0.2"),group=xvar),
stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
p<-p+scale_x_continuous(breaks=1:nlevels(data[[xvar]]),labels=levels(data[[xvar]]))
}
}
p<-p+theme(legend.position='none')
p
}
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot(heightweight,yvar="heightIn",xvar="sex",binwidth=0.4)
ggDot(radial,xvar="height",fillvar="sex",binwidth=1)
ggDot=function(data,xvar,yvar=NULL,fillvar=NULL,stackdir="center",binaxis="y",binwidth=0.5,position=0.2,boxwidth=0.25){
if(is.null(yvar)){
binaxis="x"
p<-ggplot(data,aes_string(x=xvar,fill=fillvar))+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
} else{
p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
if(position==0){
p<- p + geom_boxplot(width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
} else{
p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, ")+ 0.2"),group=xvar),width=boxwidth)+
geom_dotplot(aes_string(x=paste0("as.numeric(",xvar, ")- 0.2"),group=xvar),
stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
p<-p+scale_x_continuous(breaks=1:nlevels(data[[xvar]]),labels=levels(data[[xvar]]))
}
p<-p+theme(legend.position='none')
}
p
}
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot(heightweight,yvar="heightIn",xvar="sex",binwidth=0.4)
ggDot(radial,xvar="height",fillvar="sex",binwidth=1)
ggDot(heightweight,xvar="heightIn",fillvar="sex",binwidth=0.4)
ggDot(heightweight,xvar="heightIn",binwidth=0.4)
ggDot(heightweight,xvar="heightIn",fillvar="sex",binwidth=0.4)
ggDot(heightweight,xvar="heightIn")
ggDot(heightweight,xvar="heightIn",fillvar="sex")
ggDot(heightweight,yvar="heightIn",xvar="sex",binwidth=0.4)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot(heightweight,yvar="heightIn",xvar="sex",binwidth=0.4)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot=function(data,xvar,yvar=NULL,fillvar=NULL,
stackdir="center",binaxis="y",binwidth=0.5,position=0.2,boxwidth=0.25
boxfill=NULL){
if(is.null(yvar)){
binaxis="x"
p<-ggplot(data,aes_string(x=xvar,fill=fillvar))+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
} else{
p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
if(position==0){
p<- p + geom_boxplot(fill=boxfill,width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
} else{
p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, ")+ 0.2"),group=xvar),
fill=boxfill,width=boxwidth)+
geom_dotplot(aes_string(x=paste0("as.numeric(",xvar, ")- 0.2"),group=xvar),
stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
p<-p+scale_x_continuous(breaks=1:nlevels(data[[xvar]]),labels=levels(data[[xvar]]))
}
p<-p+theme(legend.position='none')
}
p
}
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot(heightweight,yvar="heightIn",xvar="sex",binwidth=0.4)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",boxfill="white",position=0,binwidth=1)
ggDot=function(data,xvar,yvar=NULL,fillvar=NULL,
stackdir="center",binaxis="y",binwidth=0.5,position=0.2,boxwidth=0.25,
boxfill=NULL){
if(is.null(yvar)){
binaxis="x"
p<-ggplot(data,aes_string(x=xvar,fill=fillvar))+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
} else{
p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
if(position==0){
p<- p + geom_boxplot(fill=boxfill,width=0.5)+
geom_dotplot(stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
} else{
p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, ")+ 0.2"),group=xvar),
fill=boxfill,width=boxwidth)+
geom_dotplot(aes_string(x=paste0("as.numeric(",xvar, ")- 0.2"),group=xvar),
stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
p<-p+scale_x_continuous(breaks=1:nlevels(data[[xvar]]),labels=levels(data[[xvar]]))
}
p<-p+theme(legend.position='none')
}
p
}
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",boxfill="white",position=0,binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",boxfill="white",position=0,binwidth=1,boxwidth=1)
devtools::document()
library(moonBook2)
require(moonBook)
require(gcookbook)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",boxfill="white",position=0,binwidth=1,boxwidth=1)
ggDot(heightweight,yvar="heightIn",xvar="sex",binwidth=0.4)
ggDot(heightweight,yvar="heightIn",xvar="sex",binwidth=0.4)
ggDot(heightweight,xvar="heightIn")
ggDot(heightweight,xvar="heightIn",fillvar="sex")
ggDot(heightweight,yvar="heightIn",xvar="sex",binwidth=0.4)
ggDot(heightweight,yvar="heightIn",xvar="sex")
ggDot(radial,xvar="height",fillvar="sex",binwidth=1)
library(moonBook2)
ggDot(heightweight,yvar="heightIn",xvar="sex")
ggDot(heightweight,yvar="heightIn",xvar="sex")
library(moonBook2)
ggDot(heightweight,yvar="heightIn",xvar="sex")
ggDot(heightweight,xvar="heightIn")
ggDot(heightweight,xvar="heightIn",fillvar="sex")
ggDot(heightweight,yvar="heightIn",xvar="sex")
ggDot(radial,xvar="height",fillvar="sex",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",boxfill="white",position=0,binwidth=1,boxwidth=1)
ggDot(radial,xvar="height",fillvar="sex",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot(heightweight,xvar="heightIn",fillvar="sex")
ggDot(radial,xvar="height",fillvar="sex",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",boxfill="white",position=0,binwidth=1,boxwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot(radial,xvar="height",fillvar="sex",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex")
ggDot(heightweight,yvar="heightIn",xvar="sex")
heightweight;yvar="heightIn";xvar="sex";
fillvar=NULL
stackdir="center";binaxis="y";binwidth=0.5;method="dotdensity"
position=0.2;boxwidth=0.25
boxfill=NULL
if(is.null(fillvar)) p<-ggplot(data,aes_string(x=xvar,y=yvar))
else p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
if(is.null(fillvar)) {
p<-ggplot(data,aes_string(x=xvar,y=yvar))
} else {
p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
}
if(position==0){
p<- p + geom_boxplot(fill=boxfill,width=boxwidth)+
geom_dotplot(method=method,stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
} else{
p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, ")+ 0.2"),group=xvar),
fill=boxfill,width=boxwidth)+
geom_dotplot(aes_string(x=paste0("as.numeric(",xvar, ")- 0.2"),group=xvar),
method=method,stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
p<-p+scale_x_continuous(breaks=1:nlevels(data[[xvar]]),labels=levels(data[[xvar]]))
}
p<- p + geom_boxplot(fill=boxfill,width=boxwidth)+
geom_dotplot(method=method,stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
p
data=heightweight;yvar="heightIn";xvar="sex";
fillvar=NULL
stackdir="center";binaxis="y";binwidth=0.5;method="dotdensity"
position=0.2;boxwidth=0.25
boxfill=NULL
if(is.null(fillvar)) {
p<-ggplot(data,aes_string(x=xvar,y=yvar))
} else {
p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
}
p<- p + geom_boxplot(fill=boxfill,width=boxwidth)+
geom_dotplot(method=method,stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
p
p
p<-ggplot(data,aes_string(x=xvar,y=yvar))
p<- p + geom_boxplot(fill=boxfill,width=boxwidth)+
geom_dotplot(method=method,stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
p
data=heightweight;yvar="heightIn";xvar="sex";
fillvar=NULL
stackdir="center";binaxis="y";binwidth=0.5;method="dotdensity"
position=0.2;boxwidth=0.25
boxfill=NULL
p<-ggplot(data,aes_string(x=xvar,y=yvar))
p<- p + geom_boxplot(fill=boxfill,width=boxwidth)+
geom_dotplot(method=method,stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
p
boxfill=NA
data=heightweight;yvar="heightIn";xvar="sex";
fillvar=NULL
stackdir="center";binaxis="y";binwidth=0.5;method="dotdensity"
position=0.2;boxwidth=0.25
boxfill=NA
p<-ggplot(data,aes_string(x=xvar,y=yvar))
p<- p + geom_boxplot(fill=boxfill,width=boxwidth)+
geom_dotplot(method=method,stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
p
p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, ")+ 0.2"),group=xvar),
fill=boxfill,width=boxwidth)+
geom_dotplot(aes_string(x=paste0("as.numeric(",xvar, ")- 0.2"),group=xvar),
method=method,stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
p<-p+scale_x_continuous(breaks=1:nlevels(data[[xvar]]),labels=levels(data[[xvar]]))
p
ggDot=function(data,xvar,yvar=NULL,fillvar=NULL,
stackdir="center",binaxis="y",binwidth=0.5,method="dotdensity",
position=0.2,boxwidth=0.25,
boxfill=NULL,...){
if(is.null(yvar)){
binaxis="x"
if(is.null(fillvar)) p<-ggplot(data,aes_string(x=xvar))
else p<-ggplot(data,aes_string(x=xvar,fill=fillvar))
p<-p+geom_dotplot(method=method,stackdir=stackdir,binaxis=binaxis,binwidth=binwidth,...)
} else{
if(is.null(fillvar)) {
p<-ggplot(data,aes_string(x=xvar,y=yvar))
} else {
p<-ggplot(data,aes_string(x=xvar,y=yvar,fill=fillvar))
}
if(position==0){
if(is.null(boxfill)) p<- p + geom_boxplot(width=boxwidth)
else p<- p + geom_boxplot(fill=boxfill,width=boxwidth)
p<-p+geom_dotplot(method=method,stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
} else{
if(is.null(boxfill)) p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, ")+ 0.2"),group=xvar),
width=boxwidth)
else p<- p + geom_boxplot(aes_string(x=paste0("as.numeric(",xvar, ")+ 0.2"),group=xvar),
fill=boxfill,width=boxwidth)
p<-p+geom_dotplot(aes_string(x=paste0("as.numeric(",xvar, ")- 0.2"),group=xvar),
method=method,stackdir=stackdir,binaxis=binaxis,binwidth=binwidth)
p<-p+scale_x_continuous(breaks=1:nlevels(data[[xvar]]),labels=levels(data[[xvar]]))
}
p<-p+theme(legend.position='none')
}
p
}
library(moonBook2)
ggDot(heightweight,xvar="heightIn")
ggDot(heightweight,xvar="heightIn",fillvar="sex")
ggDot(heightweight,yvar="heightIn",xvar="sex")
ggDot(radial,xvar="height",fillvar="sex",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex")
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",boxfill="white",position=0,binwidth=1,boxwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex")
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",boxfill="white",position=0,binwidth=1,boxwidth=0.5)
ggDot(heightweight,xvar="heightIn",fillvar="sex")
ggDot(heightweight,xvar="heightIn",fillvar="sex")
ggDot(heightweight,yvar="heightIn",xvar="sex",fillvar="sex")
ggDot(radial,xvar="height",fillvar="sex",binwidth=1)
ggDot(radial,xvar="height",fillvar="sex",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex")
ggDot(radial,xvar="height",fillvar="sex",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex")
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",stackdir="down",binwidth=1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",stackdir="down",binwidth=1,position=0.1)
library(moonBook2)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",stackdir="down",binwidth=1,position=0.1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",stackdir="down",binwidth=1,position=0.05)
library(moonBook2)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",stackdir="down",binwidth=1,position=0.05)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",stackdir="down",binwidth=1,position=0.1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",stackdir="down",binwidth=1,position=0.1)
ggDot(radial,yvar="height",xvar="sex",fillvar="sex",boxfill="white",position=0,binwidth=1,boxwidth=0.5)
devtools::document()
