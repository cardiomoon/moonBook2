#stat_smooth(method='glm',method.args=list(family='binomial'),se=se)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)
p
p<-ggplot(radial,aes(x=height,y=male))+
stat_smooth(method='glm',method.args=list(family='binomial'),se=se)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)
p
p<-ggplot(radial,aes(x=height,y=male))+
stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)
p
f=function(x) 1/(1+e^(-b0+b1*x))
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f,colour="red")
p
f=function(x) 1/(1+exp(-b0+b1*x))
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f,colour="red")
p
b0=coef(fit)[1]
coef(fit)
b0=coef(fit)[1]
b1=coef(fit)[2]
log(exp(10))
exp(log(10))
f=function(height) 1/(1+exp(-b0+b1*height))
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f,colour="red")
p
f=function(height) 1/(1+exp(-b0+b1*height))
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f,colour="red")
p
f=function(x) 1/(1+exp(-b0+b1*x))
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f,colour="red")
p
fit1=lm(male~height,data=radial)
fit
fit1=lm(male~height,data=radial)
fit1
coef(fit1)
f=function(x) b0+b1*x
f1=function(x) b0+b1*x
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f1,colour="red")
p
fit=glm(male~height,data=radial)
fit
summary(fit)
coef(fit)
b0=coef(fit)[1]
b1=coef(fit)[2]
f=function(x) 1/(1+exp(-b0+b1*x))
fit1=lm(male~height,data=radial)
summary(fit)
coef(fit1)
b0=coef(fit1)[1]
b1=coef(fit1)[2]
f1=function(x) b0+b1*x
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f1,colour="blue")+
stat_function(fun=f,colour="red")+
p
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f1,colour="blue")+
stat_function(fun=f,colour="red")+
p
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f1,colour="blue")+
stat_function(fun=f,colour="red")+
p
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f1,colour="blue")+
stat_function(fun=f,colour="red")+
p
fit=glm(male~height,data=radial)
fit
summary(fit)
coef(fit)
b0=coef(fit)[1]
b1=coef(fit)[2]
f=function(x) 1/(1+exp(-b1(x-b0)))
fit1=lm(male~height,data=radial)
summary(fit)
coef(fit1)
b0=coef(fit1)[1]
b1=coef(fit1)[2]
f1=function(x) b0+b1*x
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f1,colour="blue")+
stat_function(fun=f,colour="red")
p
fit=glm(male~height,data=radial)
fit
summary(fit)
coef(fit)
b0=coef(fit)[1]
b1=coef(fit)[2]
f=function(x) 1/(1+exp(-b1(x-b0)))
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f,colour="red")
p
f=function(x) 1/(1+exp(-b1*(x-b0)))
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f,colour="red")
p
f=function(x) 1/(1+exp(-b1*(x-b0)))
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f,colour="red")
p
f=function(height) 1/(1+exp(-b1*(height-b0)))
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f,colour="red")
p
fit=glm(male~height,data=radial)
fit
summary(fit)
coef(fit)
b0=coef(fit)[1]
b1=coef(fit)[2]
f=function(height) 1/(1+exp(-b1*(height+b0)))
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f,colour="red")
p
f=function(x) 1/(1+exp(-b1*(x+b0)))
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f,colour="red")
p
fit=glm(male~height,data=radial,family=binomial)
fit
summary(fit)
coef(fit)
b0=coef(fit)[1]
b1=coef(fit)[2]
f=function(x) 1/(1+exp(-b1*(x+b0)))
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f,colour="red")
p
fit=glm(male~height,data=radial,family=binomial)
fit
summary(fit)
fit
fit=glm(male~height,data=radial)
fit
fit=glm(male~height,data=radial,family=binomial)
fit
summary(fit)
coef(fit)
b0=coef(fit)[1]
b1=coef(fit)[2]
f=function(x) 1/(1+exp(-(b1*x+b0)))
p<-ggplot(radial,aes(x=height,y=male))+
#    stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f,colour="red")
p
p<-ggplot(radial,aes(x=height,y=male))+
stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
stat_function(fun=f,colour="red")
p
seq(1,10,length.out=50)
x=seq(min(radial$height),max(radial$height),length.out=100)
x=seq(min(radial$height,na.rm=T),max(radial$height,na.rm=R),length.out=100)
x=seq(min(radial$height,na.rm=T),max(radial$height,na.rm=T),length.out=100)
x
y=f(x)
df1=data.frame(x,y)
p<-ggplot(radial,aes(x=height,y=male))+
#stat_smooth(method='glm',method.args=list(family='binomial'),se=TRUE)+
geom_point(position=position_jitter(width=0.3,height=0.06),alpha=0.5)+
#stat_function(fun=f,colour="red")
geom_path(data=df1,aes(x=x,y=y))
p
ggLogReg=function(data,yvar,xvar,se=TRUE,interactive=FALSE,...){
data$id=1:nrow(data)
data$tooltip=paste0(data$id,"<br>",xvar,"=",data[[xvar]],"<br>",yvar,"=",data[[yvar]])
fit=glm(as.formula(paste0(yvar,"~",xvar)),data=data)
b0=coef(fit)[1]
b1=coef(fit)[2]
f=function(x) 1/(1+exp(-(b1*x+b0)))
x=seq(min(data[[xvar]],na.rm=T),max(data[[xvar]],na.rm=T),length.out=100)
y=f(x)
df1=data.frame(x,y)
p<-ggplot(data,aes_string(x=xvar,y=yvar))+
stat_smooth(method='glm',method.args=list(family='binomial'),se=se)+
geom_point_interactive(aes(tooltip=tooltip,data_id=id),
position=position_jitter(width=0.3,height=0.06),alpha=0.5,...)+
geom_path_interactive(data=df1,aes(x=x,y=y),data_id=1,tooltip="tooltip")
if(interactive){
tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
#hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
hover_css="r:4px;cursor:pointer;stroke-width:6px;"
selected_css = "fill:#FF3333;stroke:black;"
p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css,selected_css=selected_css)
}
p
}
require(moonBook)
ggLogReg(radial,xvar="height",yvar="male")
require(ggiraph)
ggLogReg(radial,xvar="height",yvar="male")
ggLogReg(radial,xvar="height",yvar="male",interactive=TRUE)
ggLogReg=function(data,yvar,xvar,se=TRUE,interactive=FALSE,...){
data$id=1:nrow(data)
data$tooltip=paste0(data$id,"<br>",xvar,"=",data[[xvar]],"<br>",yvar,"=",data[[yvar]])
fit=glm(as.formula(paste0(yvar,"~",xvar)),data=data)
b0=coef(fit)[1]
b1=coef(fit)[2]
f=function(x) 1/(1+exp(-(b1*x+b0)))
x=seq(min(data[[xvar]],na.rm=T),max(data[[xvar]],na.rm=T),length.out=100)
y=f(x)
df1=data.frame(x,y)
p<-ggplot(data,aes_string(x=xvar,y=yvar))+
stat_smooth(method='glm',method.args=list(family='binomial'),se=se)+
geom_point_interactive(aes(tooltip=tooltip,data_id=id),
position=position_jitter(width=0.3,height=0.06),alpha=0.5,...)+
geom_path_interactive(data=df1,aes(x=x,y=y,data_id=1,tooltip="tooltip"))
if(interactive){
tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
#hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
hover_css="r:4px;cursor:pointer;stroke-width:6px;"
selected_css = "fill:#FF3333;stroke:black;"
p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css,selected_css=selected_css)
}
p
}
ggLogReg(radial,xvar="height",yvar="male",interactive=TRUE)
n
ggLogReg=function(data,yvar,xvar,se=TRUE,interactive=FALSE,...){
data$id=1:nrow(data)
data$tooltip=paste0(data$id,"<br>",xvar,"=",data[[xvar]],"<br>",yvar,"=",data[[yvar]])
fit=glm(as.formula(paste0(yvar,"~",xvar)),data=data)
b0=coef(fit)[1]
b1=coef(fit)[2]
f=function(x) 1/(1+exp(-(b1*x+b0)))
x=seq(min(data[[xvar]],na.rm=T),max(data[[xvar]],na.rm=T),length.out=100)
y=f(x)
df1=data.frame(x,y,id="1",tooltip="tooltip")
p<-ggplot(data,aes_string(x=xvar,y=yvar,tooltip="tooltip",data_id="id"))+
stat_smooth(method='glm',method.args=list(family='binomial'),se=se)+
geom_point_interactive(position=position_jitter(width=0.3,height=0.06),alpha=0.5,...)+
geom_path_interactive(data=df1,aes(x=x,y=y))
if(interactive){
tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
#hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
hover_css="r:4px;cursor:pointer;stroke-width:6px;"
selected_css = "fill:#FF3333;stroke:black;"
p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css,selected_css=selected_css)
}
p
}
ggLogReg(radial,xvar="height",yvar="male",interactive=TRUE)
ggLogReg=function(data,yvar,xvar,se=TRUE,interactive=FALSE,...){
data$id=1:nrow(data)
data$tooltip=paste0(data$id,"<br>",xvar,"=",data[[xvar]],"<br>",yvar,"=",data[[yvar]])
fit=glm(as.formula(paste0(yvar,"~",xvar)),data=data,family=binomial)
b0=coef(fit)[1]
b1=coef(fit)[2]
f=function(x) 1/(1+exp(-(b1*x+b0)))
x=seq(min(data[[xvar]],na.rm=T),max(data[[xvar]],na.rm=T),length.out=100)
y=f(x)
df1=data.frame(x,y,id="1",tooltip="tooltip")
p<-ggplot(data,aes_string(x=xvar,y=yvar,tooltip="tooltip",data_id="id"))+
stat_smooth(method='glm',method.args=list(family='binomial'),se=se)+
geom_point_interactive(aes(tooltip=tooltip,data_id=id),
position=position_jitter(width=0.3,height=0.06),alpha=0.5,...)+
geom_path_interactive(data=df1,aes(x=x,y=y,tooltip=tooltip,data_id=id))
if(interactive){
tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
#hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
hover_css="r:4px;cursor:pointer;stroke-width:6px;"
selected_css = "fill:#FF3333;stroke:black;"
p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css,selected_css=selected_css)
}
p
}
ggLogReg(radial,xvar="height",yvar="male",interactive=TRUE)
ggLogReg=function(data,yvar,xvar,se=TRUE,interactive=FALSE,...){
data$id=1:nrow(data)
data$tooltip=paste0(data$id,"<br>",xvar,"=",data[[xvar]],"<br>",yvar,"=",data[[yvar]])
fit=glm(as.formula(paste0(yvar,"~",xvar)),data=data,family=binomial)
b0=coef(fit)[1]
b1=coef(fit)[2]
f=function(x) 1/(1+exp(-(b1*x+b0)))
x=seq(min(data[[xvar]],na.rm=T),max(data[[xvar]],na.rm=T),length.out=100)
y=f(x)
df1=data.frame(x,y,id="1",tooltip="tooltip")
p<-ggplot(data,aes_string(x=xvar,y=yvar))+
stat_smooth(method='glm',method.args=list(family='binomial'),se=se)+
geom_point_interactive(aes(tooltip=tooltip,data_id=id),
position=position_jitter(width=0.3,height=0.06),alpha=0.5,...)+
geom_path_interactive(data=df1,aes(x=x,y=y,tooltip=tooltip,data_id=id))
if(interactive){
tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
#hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
hover_css="r:4px;cursor:pointer;stroke-width:6px;"
selected_css = "fill:#FF3333;stroke:black;"
p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css,selected_css=selected_css)
}
p
}
ggLogReg(radial,xvar="height",yvar="male",interactive=TRUE)
ggLogReg=function(data,yvar,xvar,se=TRUE,interactive=FALSE,...){
data$id=1:nrow(data)
data$tooltip=paste0(data$id,"<br>",xvar,"=",data[[xvar]],"<br>",yvar,"=",data[[yvar]])
fit=glm(as.formula(paste0(yvar,"~",xvar)),data=data,family=binomial)
b0=coef(fit)[1]
b1=coef(fit)[2]
f=function(x) 1/(1+exp(-(b1*x+b0)))
x=seq(min(data[[xvar]],na.rm=T),max(data[[xvar]],na.rm=T),length.out=100)
y=f(x)
df1=data.frame(x,y,id="1",tooltip="tooltip")
p<-ggplot(data,aes_string(x=xvar,y=yvar))+
stat_smooth(method='glm',method.args=list(family='binomial'),se=se,colour=NA)+
geom_point_interactive(aes(tooltip=tooltip,data_id=id),
position=position_jitter(width=0.3,height=0.06),alpha=0.5,...)+
geom_path_interactive(data=df1,aes(x=x,y=y,tooltip=tooltip,data_id=id),colour="red")
if(interactive){
tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
#hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
hover_css="r:4px;cursor:pointer;stroke-width:6px;"
selected_css = "fill:#FF3333;stroke:black;"
p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css,selected_css=selected_css)
}
p
}
ggLogReg(radial,xvar="height",yvar="male",interactive=TRUE)
ggLogReg=function(data,yvar,xvar,se=TRUE,interactive=FALSE,...){
data$id=1:nrow(data)
data$tooltip=paste0(data$id,"<br>",xvar,"=",data[[xvar]],"<br>",yvar,"=",data[[yvar]])
fit=glm(as.formula(paste0(yvar,"~",xvar)),data=data,family=binomial)
b0=coef(fit)[1]
b1=coef(fit)[2]
f=function(x) 1/(1+exp(-(b1*x+b0)))
x=seq(min(data[[xvar]],na.rm=T),max(data[[xvar]],na.rm=T),length.out=100)
y=f(x)
df1=data.frame(x,y,id="1",tooltip="tooltip")
p<-ggplot(data,aes_string(x=xvar,y=yvar))+
stat_smooth(method='glm',method.args=list(family='binomial'),se=se,colour=NA)+
geom_point_interactive(aes(tooltip=tooltip,data_id=id),
position=position_jitter(width=0.3,height=0.06),alpha=0.5,...)+
geom_path_interactive(data=df1,aes(x=x,y=y,tooltip=tooltip,data_id=id),colour="blue",size=1)
if(interactive){
tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
#hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
hover_css="r:4px;cursor:pointer;stroke-width:6px;"
selected_css = "fill:#FF3333;stroke:black;"
p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css,selected_css=selected_css)
}
p
}
ggLogReg(radial,xvar="height",yvar="male",interactive=TRUE)
ggLogReg=function(data,yvar,xvar,se=TRUE,interactive=FALSE,digits=2,...){
data$id=1:nrow(data)
data$tooltip=paste0(data$id,"<br>",xvar,"=",data[[xvar]],"<br>",yvar,"=",data[[yvar]])
fit=glm(as.formula(paste0(yvar,"~",xvar)),data=data,family=binomial)
b0=coef(fit)[1]
b1=coef(fit)[2]
f=function(x) 1/(1+exp(-(b1*x+b0)))
x=seq(min(data[[xvar]],na.rm=T),max(data[[xvar]],na.rm=T),length.out=100)
y=f(x)
tooltip=paste0("y=1/(1+exp(-(",round(b1,digits),"x+",round(b0,digits),")))")
df1=data.frame(x,y,id="1",tooltip=tooltip)
p<-ggplot(data,aes_string(x=xvar,y=yvar))+
stat_smooth(method='glm',method.args=list(family='binomial'),se=se,colour=NA)+
geom_point_interactive(aes(tooltip=tooltip,data_id=id),
position=position_jitter(width=0.3,height=0.06),alpha=0.5,...)+
geom_path_interactive(data=df1,aes(x=x,y=y,tooltip=tooltip,data_id=id),colour="blue",size=1)
if(interactive){
tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
#hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
hover_css="r:4px;cursor:pointer;stroke-width:6px;"
selected_css = "fill:#FF3333;stroke:black;"
p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css,selected_css=selected_css)
}
p
}
ggLogReg(radial,xvar="height",yvar="male",interactive=TRUE)
ggLogReg=function(data,yvar,xvar,se=TRUE,interactive=FALSE,digits=2,...){
data$id=1:nrow(data)
data$tooltip=paste0(data$id,"<br>",xvar,"=",data[[xvar]],"<br>",yvar,"=",data[[yvar]])
fit=glm(as.formula(paste0(yvar,"~",xvar)),data=data,family=binomial)
b0=coef(fit)[1]
b1=coef(fit)[2]
f=function(x) 1/(1+exp(-(b1*x+b0)))
x=seq(min(data[[xvar]],na.rm=T),max(data[[xvar]],na.rm=T),length.out=100)
y=f(x)
tooltip=paste0("y=1/(1+exp(-(",round(b1,digits),"x",ifelse(b0>=0,"+","-"),abs(round(b0,digits)),")))")
df1=data.frame(x,y,id="1",tooltip=tooltip)
p<-ggplot(data,aes_string(x=xvar,y=yvar))+
stat_smooth(method='glm',method.args=list(family='binomial'),se=se,colour=NA)+
geom_point_interactive(aes(tooltip=tooltip,data_id=id),
position=position_jitter(width=0.3,height=0.06),alpha=0.5,...)+
geom_path_interactive(data=df1,aes(x=x,y=y,tooltip=tooltip,data_id=id),colour="blue",size=1)
if(interactive){
tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
#hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
hover_css="r:4px;cursor:pointer;stroke-width:6px;"
selected_css = "fill:#FF3333;stroke:black;"
p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css,selected_css=selected_css)
}
p
}
ggLogReg(radial,xvar="height",yvar="male",interactive=TRUE)
source('~/ownCloud/Documents/moonBook2/R/ggLogReg.R', echo=TRUE)
num2factorDf=function(data,colname,maxfactorno=6){
if(!is.null(colorvar)){
if(is.numeric(data[[colname]])&(length(unique(data[[colname]]))<=maxfactorno)){
data[[colname]]<-factor(data[[colname]])
}
}
data
}
library(moonBook2)
require(moonBook)
ggScatter(acs,yvar="weight",xvar="height",colorvar="Dx",facetvar="Dx",se=FALSE,interactive=TRUE)
ggScatter(acs,yvar="weight",xvar="height",colorvar="Dx",facetvar="Dx",se=FALSE,method="lm",interactive=TRUE)
ggScatter(iris,yvar="Sepal.Width",xvar="Sepal.Length",se=FALSE,colorvar="Species",interactive=TRUE)
ggScatter(acs,yvar="weight",xvar="height",colorvar="Dx",facetvar="Dx",se=FALSE,method="lm",interactive=TRUE)
ggScatter(iris,yvar="Sepal.Width",xvar="Sepal.Length",colorvar="Species",interactive=TRUE)
ggScatter(radial,yvar="NTAV",xvar="age",colorvar="DM",facetrvar="DM",interactive=TRUE)
library(moonBook2)
library(moonBook2)
#'ggScatter(iris,yvar="Sepal.Width",xvar="Sepal.Length",interactive=TRUE)
ggScatter(iris,yvar="Sepal.Width",xvar="Sepal.Length",interactive=TRUE)
ggScatter(iris,yvar="Sepal.Width",xvar="Sepal.Length",method="lm",interactive=TRUE)
library(moonBook2)
ggScatter(radial,yvar="male",xvar="height",method="glm")
ggScatter(radial,yvar="male",xvar="height",colorvar="smoking",method="glm")
ggScatter(radial,yvar="male",xvar="height",colorvar="smoking",method="glm",se=FALSE)
ggScatter(radial,yvar="male",xvar="height",colorvar="DM",method="glm",se=FALSE)
library(moonBook2)
ggScatter(radial,yvar="male",xvar="height",colorvar="DM",method="glm")
ggScatter(radial,yvar="male",xvar="height",colorvar="DM",method="glm",fullrange=TRUE)
ggScatter(radial,yvar="male",xvar="height",colorvar="DM",method="lm",fullrange=TRUE)
ggScatter(radial,yvar="male",xvar="height",colorvar="DM",method="glm",fullrange=TRUE)
ggScatter(radial,yvar="male",xvar="height",method="glm",fullrange=TRUE)
ggScatter(radial,yvar="male",xvar="height",method="glm",fullrange=TRUE,interactive=TRUE)
ggLogReg(radial,yvar="male",xvar="height",interactive=TRUE)
library(moonBook2)
ggScatter(radial,yvar="NTAV",xvar="age",colorvar="DM",method="lm",fullrange=TRUE,interactive=TRUE)
ggScatter(radial,yvar="NTAV",xvar="age",colorvar="DM",method="lm",facetvar="DM",fullrange=TRUE,interactive=TRUE)
library(moonBook2)
ggScatter(radial,yvar="NTAV",xvar="age",colorvar="DM",method="lm",facetvar="DM",fullrange=TRUE,interactive=TRUE)
ggScatter(radial,yvar="male",xvar="height",colorvar="DM",method="glm",facetvar="DM",fullrange=TRUE,interactive=TRUE)
ggScatter(radial,yvar="male",xvar="height",colorvar="DM",method="glm",facetvar="smoking",fullrange=TRUE,interactive=TRUE)
ggScatter(radial,yvar="male",xvar="height",colorvar="DM",method="glm",facetvar="DM",fullrange=TRUE,interactive=TRUE)
library(moonBook2)
ggScatter(radial,yvar="male",xvar="height",colorvar="DM",method="glm",facetvar="DM",fullrange=TRUE,interactive=TRUE)
ggScatter(radial,yvar="male",xvar="height",colorvar="DM",method="glm",se=FALSE,,fullrange=TRUE,interactive=TRUE)
ggScatter(radial,yvar="male",xvar="height",colorvar="DM",method="glm",se=FALSE,,fullrange=TRUE)
library(moonBook2)
require(moonBook)
require(ggplot2)
require(ggiraph)
ggBar(acs,"Dx","smoking",interactive=TRUE,width=1,colour="white",size=0.2,polar=TRUE)
require(moonBook2)
ggBar(acs,"Dx","smoking",interactive=TRUE,width=1,colour="white",size=0.2,polar=TRUE)
ggBar(rose,Month,group,"value",stat="identity",polar=TRUE,palette="Reds",width=1,
color="black",size=0.1,interactive=TRUE)
ggBar(rose,Month,group,"value",stat="identity",polar=TRUE,palette="Reds",width=1,
color="black",size=0.1,interactive=TRUE,addlabel=TRUE)
ggBar(rose,Month,group,"value",stat="identity",polar=TRUE,palette="Reds",width=1,
color="black",size=0.1,addlabel=TRUE)
str(rose)
