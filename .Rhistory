tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
if(interactive) p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css)
}
p
}
ggScatter(se=FALSE,colorvar="Species")
ggScatter(addloess=FALSE,colorvar="Species",interactive=TRUE)
ggScatter(Prestige,"income","prestige",interactive=TRUE)
ggScatter(Prestige,"income","prestige",addloess=TRUE,interactive=TRUE)
ggPair(iris,colorvar="Species",interactive=TRUE)
ggScatter(addloess=FALSE,colorvar="Species",interactive=TRUE)
shiny::runApp(appDir = system.file("shiny/crimes", package = "ggiraph"), display.mode = "showcase")
shiny::runApp(appDir = system.file("shiny/cars", package = "ggiraph"), display.mode = "showcase")
ggScatter=function(data=iris,xvar="Sepal.Length",yvar="Sepal.Width",se=TRUE,addloess=FALSE,
loessse=FALSE,colorvar=NULL,interactive=FALSE){
df=data[c(xvar,yvar,colorvar)]
df$id=1:nrow(df)
df$tooltip=paste0(xvar,":",df[[xvar]],"<br>",yvar,":",df[[yvar]])
if(!is.null(colorvar)) df$tooltip=paste0(df$tooltip,"<br>",colorvar,":",df[[colorvar]])
if(is.null(colorvar)){
myformula=as.formula(paste0(yvar,"~",xvar))
fit=lm(myformula,data=df)
intercept=coef(fit)[1]
slope=coef(fit)[2]
xmin=min(df[[xvar]])
xmax=max(df[[xvar]])
ymin=xmin*slope+intercept
ymax=xmax*slope+intercept
x=c(xmin,xmax)
y=c(ymin,ymax)
tooltip=makeEquation(fit)[1]
df3=data.frame(x,y,tooltip)
df3$id=1:nrow(df3)
df
df3
p<-ggplot(data=df,aes_string(x=xvar,y=yvar))
if(se) p<-p+ geom_smooth(method="lm")
if(addloess) p<-p+ geom_smooth(colour="red",se=loessse)
p<-p+ geom_path_interactive(data=df3,aes_string(x="x",y="y",
data_id="id",tooltip="tooltip"),color="blue",size=1)+
geom_point_interactive(aes(data_id=id,tooltip=tooltip))
p
} else {
group=unique(df[[colorvar]])
name<-intercept<-slope<-xmin<-xmax<-ymin<-ymax<-tooltip<-c()
for(i in 1 :length(group)){
subdf=data[data[[colorvar]]==group[i],]
myformula=as.formula(paste0(yvar,"~",xvar))
fit=lm(myformula,data=subdf)
if(is.factor(df[[colorvar]])) name<-c(name,levels(df[[colorvar]])[i])
else name<-c(name,group[i])
intercept=c(intercept,coef(fit)[1])
slope=c(slope,coef(fit)[2])
xmin=c(xmin,min(subdf[[xvar]]))
xmax=c(xmax,max(subdf[[xvar]]))
ymin=c(ymin,min(subdf[[xvar]])*coef(fit)[2]+coef(fit)[1])
ymax=c(ymax,max(subdf[[xvar]])*coef(fit)[2]+coef(fit)[1])
tooltip=c(tooltip,makeEquation(fit))
}
df2=data.frame(name,intercept,slope,xmin,xmax,ymin,ymax,tooltip)
x=c(df2$xmin,df2$xmax)
y=c(df2$ymin,df2$ymax)
color=rainbow(length(group))
df3=data.frame(x,y,color,df2$name,tooltip)
colnames(df3)[4]=colorvar
df3$id=1:nrow(df3)
p<-ggplot(data=df,aes_string(x=xvar,y=yvar,color=colorvar))
if(se) p<-p+ geom_smooth(method="lm")
if(addloess) p<-p+ geom_smooth(se=loessse)
p<-p+ geom_path_interactive(data=df3,aes_string(x="x",y="y",
color=colorvar,data_id="id",tooltip="tooltip"),size=1)+
geom_point_interactive(aes(data_id=id,tooltip=tooltip))
}
if(interactive){
tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
if(interactive) p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css)
}
p
}
ggScatter(Prestige,"income","prestige",addloess=TRUE,interactive=TRUE)
ggScatter(Prestige,"income","prestige",addloess=TRUE,se=FALSE,loessse=TRUE,interactive=TRUE)
ggScatter(addloess=FALSE,colorvar="Species",interactive=TRUE)
ggScatter(se=FALSE,colorvar="Species")
ggScatter(se=FALSE,colorvar="Species",interactive=TRUE)
ggScatter(data=acs,"height","weight")
require(moonBook)
ggScatter(data=acs,"height","weight")
ggScatter(data=acs,"height","weight",intercative=TRUE)
ggScatter(data=acs,"height","weight","sex",interactive=TRUE)
ggScatter(data=acs,"height","weight","sex",interactive=TRUE)
ggScatter=function(data=iris,xvar="Sepal.Length",yvar="Sepal.Width",se=TRUE,addloess=FALSE,
loessse=FALSE,colorvar=NULL,interactive=FALSE){
df=data[c(xvar,yvar,colorvar)]
df$id=1:nrow(df)
df$tooltip=paste0(xvar,":",df[[xvar]],"<br>",yvar,":",df[[yvar]])
if(!is.null(colorvar)) df$tooltip=paste0(df$tooltip,"<br>",colorvar,":",df[[colorvar]])
if(is.null(colorvar)){
myformula=as.formula(paste0(yvar,"~",xvar))
fit=lm(myformula,data=df)
intercept=coef(fit)[1]
slope=coef(fit)[2]
xmin=min(df[[xvar]])
xmax=max(df[[xvar]])
ymin=xmin*slope+intercept
ymax=xmax*slope+intercept
x=c(xmin,xmax)
y=c(ymin,ymax)
tooltip=makeEquation(fit)[1]
df3=data.frame(x,y,tooltip)
df3$id=1:nrow(df3)
df
df3
p<-ggplot(data=df,aes_string(x=xvar,y=yvar))
if(se) p<-p+ geom_smooth(method="lm")
if(addloess) p<-p+ geom_smooth(colour="red",se=loessse)
p<-p+ geom_path_interactive(data=df3,aes_string(x="x",y="y",
data_id="id",tooltip="tooltip"),color="blue",size=1)+
geom_point_interactive(aes(data_id=id,tooltip=tooltip))
p
} else {
group=unique(df[[colorvar]])
name<-intercept<-slope<-xmin<-xmax<-ymin<-ymax<-tooltip<-c()
for(i in 1 :length(group)){
subdf=data[data[[colorvar]]==group[i],]
myformula=as.formula(paste0(yvar,"~",xvar))
fit=lm(myformula,data=subdf)
if(is.factor(df[[colorvar]])) name<-c(name,levels(df[[colorvar]])[i])
else name<-c(name,group[i])
intercept=c(intercept,coef(fit)[1])
slope=c(slope,coef(fit)[2])
xmin=c(xmin,min(subdf[[xvar]]))
xmax=c(xmax,max(subdf[[xvar]]))
ymin=c(ymin,min(subdf[[xvar]])*coef(fit)[2]+coef(fit)[1])
ymax=c(ymax,max(subdf[[xvar]])*coef(fit)[2]+coef(fit)[1])
tooltip=c(tooltip,makeEquation(fit))
}
df2=data.frame(name,intercept,slope,xmin,xmax,ymin,ymax,tooltip)
x=c(df2$xmin,df2$xmax)
y=c(df2$ymin,df2$ymax)
color=rainbow(length(group))
df3=data.frame(x,y,color,df2$name,tooltip)
colnames(df3)[4]=colorvar
df3$id=1:nrow(df3)
p<-ggplot(data=df,aes_string(x=xvar,y=yvar,color=colorvar))
if(se) p<-p+ geom_smooth(method="lm")
if(addloess) p<-p+ geom_smooth(se=loessse)
p<-p+ geom_path_interactive(data=df3,aes_string(x="x",y="y",
color=colorvar,data_id="id",tooltip="tooltip"),size=1)+
geom_point_interactive(aes(data_id=id,tooltip=tooltip))
}
if(interactive){
tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
if(interactive) p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css)
}
p
}
ggScatter(se=FALSE,colorvar="Species",interactive=TRUE)
ggScatter(data=acs,"height","weight","sex",interactive=TRUE)
ggScatter=function(data=iris,xvar="Sepal.Length",yvar="Sepal.Width",colorvar=NULL,se=TRUE,addloess=FALSE,
loessse=FALSE,interactive=FALSE){
df=data[c(xvar,yvar,colorvar)]
df$id=1:nrow(df)
df$tooltip=paste0(xvar,":",df[[xvar]],"<br>",yvar,":",df[[yvar]])
if(!is.null(colorvar)) df$tooltip=paste0(df$tooltip,"<br>",colorvar,":",df[[colorvar]])
if(is.null(colorvar)){
myformula=as.formula(paste0(yvar,"~",xvar))
fit=lm(myformula,data=df)
intercept=coef(fit)[1]
slope=coef(fit)[2]
xmin=min(df[[xvar]])
xmax=max(df[[xvar]])
ymin=xmin*slope+intercept
ymax=xmax*slope+intercept
x=c(xmin,xmax)
y=c(ymin,ymax)
tooltip=makeEquation(fit)[1]
df3=data.frame(x,y,tooltip)
df3$id=1:nrow(df3)
df
df3
p<-ggplot(data=df,aes_string(x=xvar,y=yvar))
if(se) p<-p+ geom_smooth(method="lm")
if(addloess) p<-p+ geom_smooth(colour="red",se=loessse)
p<-p+ geom_path_interactive(data=df3,aes_string(x="x",y="y",
data_id="id",tooltip="tooltip"),color="blue",size=1)+
geom_point_interactive(aes(data_id=id,tooltip=tooltip))
p
} else {
group=unique(df[[colorvar]])
name<-intercept<-slope<-xmin<-xmax<-ymin<-ymax<-tooltip<-c()
for(i in 1 :length(group)){
subdf=data[data[[colorvar]]==group[i],]
myformula=as.formula(paste0(yvar,"~",xvar))
fit=lm(myformula,data=subdf)
if(is.factor(df[[colorvar]])) name<-c(name,levels(df[[colorvar]])[i])
else name<-c(name,group[i])
intercept=c(intercept,coef(fit)[1])
slope=c(slope,coef(fit)[2])
xmin=c(xmin,min(subdf[[xvar]]))
xmax=c(xmax,max(subdf[[xvar]]))
ymin=c(ymin,min(subdf[[xvar]])*coef(fit)[2]+coef(fit)[1])
ymax=c(ymax,max(subdf[[xvar]])*coef(fit)[2]+coef(fit)[1])
tooltip=c(tooltip,makeEquation(fit))
}
df2=data.frame(name,intercept,slope,xmin,xmax,ymin,ymax,tooltip)
x=c(df2$xmin,df2$xmax)
y=c(df2$ymin,df2$ymax)
color=rainbow(length(group))
df3=data.frame(x,y,color,df2$name,tooltip)
colnames(df3)[4]=colorvar
df3$id=1:nrow(df3)
p<-ggplot(data=df,aes_string(x=xvar,y=yvar,color=colorvar))
if(se) p<-p+ geom_smooth(method="lm")
if(addloess) p<-p+ geom_smooth(se=loessse)
p<-p+ geom_path_interactive(data=df3,aes_string(x="x",y="y",
color=colorvar,data_id="id",tooltip="tooltip"),size=1)+
geom_point_interactive(aes(data_id=id,tooltip=tooltip))
}
if(interactive){
tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
if(interactive) p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css)
}
p
}
ggScatter(data=acs,"height","weight","sex",interactive=TRUE)
ggScatter(data=acs,"height","weight","sex",interactive=TRUE)
ggScatter(data=acs,"height","weight",colorvar="sex",interactive=TRUE)
ggScatter(se=FALSE,colorvar="Species",interactive=TRUE)
ggScatter(data=acs,"height","weight",colorvar="smoking",interactive=TRUE)
ggScatter(data=acs,"height","weight",colorvar="smoking",se=FALSE,interactive=TRUE)
ggScatter(data=acs,"height","weight",colorvar="smoking",se=FALSE,interactive=TRUE)
ggScatter=function(data,xvar,yvar,colorvar=NULL,se=TRUE,addloess=FALSE,
loessse=FALSE,interactive=FALSE){
df=data[c(xvar,yvar,colorvar)]
df$id=1:nrow(df)
df$tooltip=paste0(xvar,":",df[[xvar]],"<br>",yvar,":",df[[yvar]])
if(!is.null(colorvar)) df$tooltip=paste0(df$tooltip,"<br>",colorvar,":",df[[colorvar]])
if(is.null(colorvar)){
myformula=as.formula(paste0(yvar,"~",xvar))
fit=lm(myformula,data=df)
intercept=coef(fit)[1]
slope=coef(fit)[2]
xmin=min(df[[xvar]])
xmax=max(df[[xvar]])
ymin=xmin*slope+intercept
ymax=xmax*slope+intercept
x=c(xmin,xmax)
y=c(ymin,ymax)
tooltip=makeEquation(fit)[1]
df3=data.frame(x,y,tooltip)
df3$id=1:nrow(df3)
df
df3
p<-ggplot(data=df,aes_string(x=xvar,y=yvar))
if(se) p<-p+ geom_smooth(method="lm")
if(addloess) p<-p+ geom_smooth(colour="red",se=loessse)
p<-p+ geom_path_interactive(data=df3,aes_string(x="x",y="y",
data_id="id",tooltip="tooltip"),color="blue",size=1)+
geom_point_interactive(aes(data_id=id,tooltip=tooltip))
p
} else {
group=unique(df[[colorvar]])
name<-intercept<-slope<-xmin<-xmax<-ymin<-ymax<-tooltip<-c()
for(i in 1 :length(group)){
subdf=data[data[[colorvar]]==group[i],]
myformula=as.formula(paste0(yvar,"~",xvar))
fit=lm(myformula,data=subdf)
if(is.factor(df[[colorvar]])) name<-c(name,levels(df[[colorvar]])[i])
else name<-c(name,group[i])
intercept=c(intercept,coef(fit)[1])
slope=c(slope,coef(fit)[2])
xmin=c(xmin,min(subdf[[xvar]]))
xmax=c(xmax,max(subdf[[xvar]]))
ymin=c(ymin,min(subdf[[xvar]])*coef(fit)[2]+coef(fit)[1])
ymax=c(ymax,max(subdf[[xvar]])*coef(fit)[2]+coef(fit)[1])
tooltip=c(tooltip,makeEquation(fit))
}
df2=data.frame(name,intercept,slope,xmin,xmax,ymin,ymax,tooltip)
x=c(df2$xmin,df2$xmax)
y=c(df2$ymin,df2$ymax)
color=rainbow(length(group))
df3=data.frame(x,y,color,df2$name,tooltip)
colnames(df3)[4]=colorvar
df3$id=1:nrow(df3)
p<-ggplot(data=df,aes_string(x=xvar,y=yvar,color=colorvar))
if(se) p<-p+ geom_smooth(method="lm")
if(addloess) p<-p+ geom_smooth(se=loessse)
p<-p+ geom_path_interactive(data=df3,aes_string(x="x",y="y",
color=colorvar,data_id="id",tooltip="tooltip"),size=1)+
geom_point_interactive(aes(data_id=id,tooltip=tooltip))
}
if(interactive){
tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
if(interactive) p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css)
}
p
}
ggScatter(data=iris,xvar="Sepal.Length",yvar="Sepal.Width",se=FALSE,colorvar="Species",interactive=TRUE)
ggScatter(data=acs,xvar="height",yvar="weight",colorvar="smoking",se=FALSE,interactive=TRUE)
ggScatter(data=acs,xvar="height",yvar="weight",colorvar="sex",se=FALSE,interactive=TRUE)
ggScatter(data=acs,xvar="height",yvar="weight",colorvar="sex",se=FALSE,interactive=TRUE)
ggScatter(data=acs,xvar="height",yvar="weight",colorvar="Dx",se=FALSE,interactive=TRUE)
ggScatter(data=acs,xvar="height",yvar="weight",colorvar="Dx",se=TRUE,interactive=TRUE)
ggScatter(data=acs,xvar="height",yvar="weight",colorvar="Dx",se=FALSE,interactive=TRUE)
ggScatter(data=iris,xvar="Sepal.Length",yvar="Sepal.Width",se=FALSE,colorvar="Species",interactive=TRUE)
ggScatter(data=acs,xvar="height",yvar="weight",colorvar="Dx",se=FALSE,interactive=TRUE)
ggScatter=function(data,xvar,yvar,colorvar=NULL,se=TRUE,addloess=FALSE,
loessse=FALSE,interactive=FALSE){
df=data[c(xvar,yvar,colorvar)]
df$id=1:nrow(df)
df$tooltip=paste0(xvar,":",df[[xvar]],"<br>",yvar,":",df[[yvar]])
if(!is.null(colorvar)) df$tooltip=paste0(df$tooltip,"<br>",colorvar,":",df[[colorvar]])
if(is.null(colorvar)){
myformula=as.formula(paste0(yvar,"~",xvar))
fit=lm(myformula,data=df)
intercept=coef(fit)[1]
slope=coef(fit)[2]
xmin=min(df[[xvar]])
xmax=max(df[[xvar]])
ymin=xmin*slope+intercept
ymax=xmax*slope+intercept
x=c(xmin,xmax)
y=c(ymin,ymax)
tooltip=makeEquation(fit)[1]
df3=data.frame(x,y,tooltip)
df3$id=1:nrow(df3)
df
df3
p<-ggplot(data=df,aes_string(x=xvar,y=yvar))
if(se) p<-p+ geom_smooth(method="lm")
if(addloess) p<-p+ geom_smooth(colour="red",se=loessse)
p<-p+ geom_path_interactive(data=df3,aes_string(x="x",y="y",
data_id="id",tooltip="tooltip"),color="blue",size=1)+
geom_point_interactive(aes(data_id=id,tooltip=tooltip))
p
} else {
group=unique(df[[colorvar]])
name<-intercept<-slope<-xmin<-xmax<-ymin<-ymax<-tooltip<-c()
for(i in 1 :length(group)){
subdf=data[data[[colorvar]]==group[i],]
myformula=as.formula(paste0(yvar,"~",xvar))
fit=lm(myformula,data=subdf)
if(is.factor(df[[colorvar]])) name<-c(name,levels(df[[colorvar]])[i])
else name<-c(name,group[i])
intercept=c(intercept,coef(fit)[1])
slope=c(slope,coef(fit)[2])
xmin=c(xmin,min(subdf[[xvar]]))
xmax=c(xmax,max(subdf[[xvar]]))
ymin=c(ymin,min(subdf[[xvar]])*coef(fit)[2]+coef(fit)[1])
ymax=c(ymax,max(subdf[[xvar]])*coef(fit)[2]+coef(fit)[1])
tooltip=c(tooltip,makeEquation(fit))
}
df2=data.frame(name,intercept,slope,xmin,xmax,ymin,ymax,tooltip)
x=c(df2$xmin,df2$xmax)
y=c(df2$ymin,df2$ymax)
color=rainbow(length(group))
df3=data.frame(x,y,color,df2$name,tooltip)
colnames(df3)[4]=colorvar
df3$id=1:nrow(df3)
str(df3)
p<-ggplot(data=df,aes_string(x=xvar,y=yvar,color=colorvar))
if(se) p<-p+ geom_smooth(method="lm")
if(addloess) p<-p+ geom_smooth(se=loessse)
p<-p+ geom_path_interactive(data=df3,aes_string(x="x",y="y",
color=colorvar,data_id="id",tooltip="tooltip"),size=1)+
geom_point_interactive(aes(data_id=id,tooltip=tooltip))
}
if(interactive){
tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
if(interactive) p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css)
}
p
}
ggScatter(data=iris,xvar="Sepal.Length",yvar="Sepal.Width",se=FALSE,colorvar="Species",interactive=TRUE)
ggScatter(data=acs,xvar="height",yvar="weight",colorvar="Dx",se=FALSE,interactive=TRUE)
data=acs;xvar="height";yvar="weight";colorvar="sex"
data=acs;xvar="height";yvar="weight";colorvar="sex"
se=TRUE;addloess=FALSE;
loessse=FALSE;interactive=TRUE
df=data[c(xvar,yvar,colorvar)]
df$id=1:nrow(df)
df$tooltip=paste0(xvar,":",df[[xvar]],"<br>",yvar,":",df[[yvar]])
if(!is.null(colorvar)) df$tooltip=paste0(df$tooltip,"<br>",colorvar,":",df[[colorvar]])
group=unique(df[[colorvar]])
name<-intercept<-slope<-xmin<-xmax<-ymin<-ymax<-tooltip<-c()
for(i in 1 :length(group)){
subdf=data[data[[colorvar]]==group[i],]
myformula=as.formula(paste0(yvar,"~",xvar))
fit=lm(myformula,data=subdf)
if(is.factor(df[[colorvar]])) name<-c(name,levels(df[[colorvar]])[i])
else name<-c(name,group[i])
intercept=c(intercept,coef(fit)[1])
slope=c(slope,coef(fit)[2])
xmin=c(xmin,min(subdf[[xvar]]))
xmax=c(xmax,max(subdf[[xvar]]))
ymin=c(ymin,min(subdf[[xvar]])*coef(fit)[2]+coef(fit)[1])
ymax=c(ymax,max(subdf[[xvar]])*coef(fit)[2]+coef(fit)[1])
tooltip=c(tooltip,makeEquation(fit))
}
df2=data.frame(name,intercept,slope,xmin,xmax,ymin,ymax,tooltip)
x=c(df2$xmin,df2$xmax)
y=c(df2$ymin,df2$ymax)
color=rainbow(length(group))
df3=data.frame(x,y,color,df2$name,tooltip)
colnames(df3)[4]=colorvar
df3$id=1:nrow(df3)
str(df3)
df2
min(acs$height)
min(acs$height,na.rm=T)
ggScatter=function(data,xvar,yvar,colorvar=NULL,se=TRUE,addloess=FALSE,
loessse=FALSE,interactive=FALSE){
df=data[c(xvar,yvar,colorvar)]
df$id=1:nrow(df)
df$tooltip=paste0(xvar,":",df[[xvar]],"<br>",yvar,":",df[[yvar]])
if(!is.null(colorvar)) df$tooltip=paste0(df$tooltip,"<br>",colorvar,":",df[[colorvar]])
if(is.null(colorvar)){
myformula=as.formula(paste0(yvar,"~",xvar))
fit=lm(myformula,data=df)
intercept=coef(fit)[1]
slope=coef(fit)[2]
xmin=min(df[[xvar]])
xmax=max(df[[xvar]])
ymin=xmin*slope+intercept
ymax=xmax*slope+intercept
x=c(xmin,xmax)
y=c(ymin,ymax)
tooltip=makeEquation(fit)[1]
df3=data.frame(x,y,tooltip)
df3$id=1:nrow(df3)
df
df3
p<-ggplot(data=df,aes_string(x=xvar,y=yvar))
if(se) p<-p+ geom_smooth(method="lm")
if(addloess) p<-p+ geom_smooth(colour="red",se=loessse)
p<-p+ geom_path_interactive(data=df3,aes_string(x="x",y="y",
data_id="id",tooltip="tooltip"),color="blue",size=1)+
geom_point_interactive(aes(data_id=id,tooltip=tooltip))
p
} else {
group=unique(df[[colorvar]])
name<-intercept<-slope<-xmin<-xmax<-ymin<-ymax<-tooltip<-c()
for(i in 1 :length(group)){
subdf=data[data[[colorvar]]==group[i],]
myformula=as.formula(paste0(yvar,"~",xvar))
fit=lm(myformula,data=subdf)
if(is.factor(df[[colorvar]])) name<-c(name,levels(df[[colorvar]])[i])
else name<-c(name,group[i])
intercept=c(intercept,coef(fit)[1])
slope=c(slope,coef(fit)[2])
xmin=c(xmin,min(subdf[[xvar]],na.rm=T))
xmax=c(xmax,max(subdf[[xvar]],na.rm=T))
ymin=c(ymin,min(subdf[[xvar]],na.rm=T)*coef(fit)[2]+coef(fit)[1])
ymax=c(ymax,max(subdf[[xvar]],na.rm=T)*coef(fit)[2]+coef(fit)[1])
tooltip=c(tooltip,makeEquation(fit))
}
df2=data.frame(name,intercept,slope,xmin,xmax,ymin,ymax,tooltip)
x=c(df2$xmin,df2$xmax)
y=c(df2$ymin,df2$ymax)
color=rainbow(length(group))
df2
df3=data.frame(x,y,color,df2$name,tooltip)
colnames(df3)[4]=colorvar
df3$id=1:nrow(df3)
str(df3)
p<-ggplot(data=df,aes_string(x=xvar,y=yvar,color=colorvar))
if(se) p<-p+ geom_smooth(method="lm")
if(addloess) p<-p+ geom_smooth(se=loessse)
p<-p+ geom_path_interactive(data=df3,aes_string(x="x",y="y",
color=colorvar,data_id="id",tooltip="tooltip"),size=1)+
geom_point_interactive(aes(data_id=id,tooltip=tooltip))
}
if(interactive){
tooltip_css <- "background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px;"
hover_css="fill-opacity=.3;cursor:pointer;stroke:gold;"
if(interactive) p<-ggiraph(code=print(p),tooltip_extra_css=tooltip_css,tooltip_opacity=.75,
zoom_max=10,hover_css=hover_css)
}
p
}
ggScatter(data=acs,xvar="height",yvar="weight",colorvar="Dx",se=FALSE,interactive=TRUE)
devtools::document()
library(moonBook2)
library(moonBook2)
#'KS2016=get_popdata("KS",2016)
#'ggBidirectionalBar2(data=KS2016,left="Male",right="Female",label="Age")
KS2016=get_popdata("KS",2016)
ggBidirectionalBar2(data=KS2016,left="Male",right="Female",label="Age")
require(grid)
ggBidirectionalBar2(data=KS2016,left="Male",right="Female",label="Age")
ggBidirectionalBar2(data=KS2016,left="Male",right="Female",label="Age",width=c(0.3,0.7))
ggBidirectionalBar(data=KS2016,left="Male",right="Female",label="Age",legendposition=2)
ggBidirectionalBar(data=KS2016,left="Male",right="Female",label="Age",legendposition=3)
ggBidirectionalBar(data=KS2016,left="Male",right="Female",label="Age",legendposition=4)
ggBidirectionalBar(data=KS2016,left="Male",right="Female",label="Age",legendposition=2)
ggBidirectionalBar2(data=KS2016,left="Male",right="Female",label="Age",width=c(0.3,0.7))
devtools::document()
library(moonBook2)
library(moonBook2)
library(moonBook2)
